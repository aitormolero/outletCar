{% extends 'base.html' %}
{% load static %}

{% block title %}Agregar Coche - Car Management{% endblock %}
{% block añadir-coche-active %} active {% endblock %}
{% block content %}

    <!-- Page Header Start -->
    <div class="container-fluid page-header">
        <h2 class="display-3 text-uppercase text-white mb-3">Agregar Coche</h2>
        <div class="d-inline-flex text-white">
            <h6 class="text-uppercase m-0"><a class="text-white" href="">Inicio</a></h6>
            <h6 class="text-body m-0 px-3">/</h6>
            <h6 class="text-uppercase text-body m-0">Agregar Coche</h6>
        </div>
    </div>
    <!-- Page Header End -->

    <!-- Formulario Start -->
    <div class="container py-5">
        <h2 class="display-4 text-uppercase text-center mb-5 pb-5">Introduce los Detalles del Coche</h2>
        <div class="row justify-content-center">
            <div class="col-lg-9 col-md-10 col-12">
                <div class="card shadow-lg border-0">
                    <div class="card-header text-center bg-primary text-white">
                        <h3>Añadir Coche</h3>
                        <p class="mb-0">Completa los detalles para añadir un nuevo coche a la base de datos</p>
                    </div>
                    <div class="card-body bg-light p-5">
                        <form method="post" action="{% url 'añadir_coche' %}" enctype="multipart/form-data">

                             {% csrf_token %}  <!-- Necesario el token CSRF para añadir el coche a la BD -->

                            <!-- Año, Precio y Color -->
                            <div class="row mb-4 text-center">
                                <div class="col-md-4">
                                    <label for="anio" class="form-label">Año</label>
                                    <input type="number" name="anio" class="form-control" placeholder="Año" min="1975" required>
                                </div>
                                <div class="col-md-4">
                                    <label for="precio" class="form-label">Precio (€)</label>
                                    <input type="number" step="0.01" name="precio" class="form-control" placeholder="Precio (€)" min="10000" required>
                                </div>
                                <div class="col-md-4">
                                    <label for="color" class="form-label">Color</label>
                                    <input type="text" name="color" class="form-control" placeholder="Color" required>
                                </div>
                            </div>

                            <!-- Kilometraje y Modelo -->
                            <div class="row mb-4 text-center">
                                <div class="col-md-6">
                                    <label for="kilometraje" class="form-label">Kilometraje</label>
                                    <input type="number" name="kilometraje" class="form-control" min="10000" placeholder="Kilómetros recorridos" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="modelo" class="form-label">Modelo</label>
                                    <input type="text" name="modelo" class="form-control" placeholder="Modelo" required>
                                </div>
                            </div>

                            <!-- Combustible, Tracción y Transmisión -->
                            <div class="row mb-4 text-center">
                                <div class="col-md-4">
                                    <label for="combustible" class="form-label">Combustible</label>
                                    <select name="combustible" class="form-select" required>
                                        <option value="" disabled selected>Selecciona un combustible</option>
                                        {% for key, value in combustibles %}
                                            <option value="{{ key }}">{{ value }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="traccion" class="form-label">Tracción</label>
                                    <select name="traccion" class="form-select" required>
                                        <option value="" disabled selected>Selecciona una traccion</option>
                                        {% for key, value in tracciones %}
                                            <option value="{{ key }}">{{ value }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="transmision" class="form-label">Transmisión</label>
                                    <select name="transmision" class="form-select" required>
                                        <option value="" disabled selected>Selecciona una transmision</option>
                                        {% for key, value in transmisiones %}
                                            <option value="{{ key }}">{{ value }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <!-- Es Descapotable, Marca y Puertas -->
                            <div class="row mb-4 text-center">
                                <div class="col-md-4">
                                    <label for="descapotable" class="form-label">¿Es Descapotable?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="descapotable" value="True">
                                        <label class="form-check-label">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="descapotable" value="False" checked>
                                        <label class="form-check-label">No</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <label for="numero_puertas" class="form-label">Número de Puertas</label>
                                    <select name="numero_puertas" class="form-select" required>
                                        <option value="" disabled selected>Selecciona un n° puertas</option>
                                        {% for key, value in numero_puertas %}
                                            <option value="{{ key }}">{{ value }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="marca" class="form-label">Marca</label>
                                    <select name="marca" class="form-select" required>
                                        <option value="" disabled selected>Selecciona una marca</option>
                                        {% for marca in marcas %}
                                            <option value="{{ marca.id }}">{{ marca.nombre }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <!-- Foto y Categorías a la misma altura -->
                            <div class="row mb-4 text-center">
                                <div class="col-md-6">
                                    <label for="imagen" class="form-label">Subir Foto</label>
                                    <input type="file" name="imagen" class="form-control" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="categorias" class="form-label">Categorías</label>
                                    <div class="input-group justify-content-center">
                                        <select id="categoria-selector" name="categorias" class="form-select">
                                            <option value="" disabled selected>Selecciona una categoría</option>
                                            {% for categoria in categorias %}
                                                <option value="{{ categoria.id }}">{{ categoria.nombre }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div id="categorias-seleccionadas" class="mt-3 row gy-2 justify-content-center">
                                        <!-- Tarjetas de categorías seleccionadas -->
                                    </div>
                                    <input type="hidden" name="categoria" id="categorias-input">
                                </div>
                            </div>

                            <!-- Descripción -->
                            <div class="mb-4">
                                <label for="descripcion" class="form-label">Descripción</label>
                                <textarea name="descripcion" class="form-control" rows="5" placeholder="Descripción del coche..." required></textarea>
                            </div>

                            <!-- Botón de Enviar -->
                            <div class="text-center">
                                <button type="submit" class="btn btn-primary px-5 py-2 rounded-pill">Añadir Coche</button>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Formulario End -->

{% endblock %}
